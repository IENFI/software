<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <link rel="stylesheet" href="/css/style.css">
    <link rel="stylesheet" href="/css/header.css">
    <link rel="stylesheet" href="/css/contents.css">
    <link rel="stylesheet" href="/css/footer.css">
    <title>Document</title>
    <style>
        table{
            border-spacing: 0;
        }
        td{
            border:solid black 1px !important;
            height:150px;
            width:200px;
            position:relative;
            vertical-align: top;
            
        }
        .plan_div{
            border:solid 1px;
            height:120px;
            margin:5px;
        }
        .inner{
            display:flex;
            align-items: center;
            justify-content: center;
        }
        #today{
            background-color: yellow;
        }
    </style>
</head>
<body>
    <header id="header">       
        <div class="inner">
            <a href="index.html" id="dms"><img src="/img/DMS.png" height="80" onclick=""></a>
            <ul class="nav">
                 <li><a href="board.html" class="nav_item">게시판</a></li>
                 <li><a href="study.html" class="nav_item">공부기록</a></li>
                 <li><a href="plan.html" class="nav_item">일정</a></li>
            </ul>
             <span id="message"><img src="/img/message.png" id = message_icon onclick=""></span>
             <span id="profile">
                   <li><a href="#"><img src="/img/profile.png" id = profile_icon  onclick=""></a>
                       <ul id="profile_dropdown">
                          <li><a href="#" class="dropdown_item">내 정보</a></li>
                          <li><a href="#" class="dropdown_item">로그아웃</a></li>
                       </ul>                 
                 </li>
            </span>
        </div>      
    </header>
    <section id="contents">
        <div class="inner">
            <div id="plan_container">
                <div id="Calendar_header">
                    <span id="currentYearMonth"></span>
                    <button class="prev" onclick="showCalendar(-1)">이전 월</button>
                    <button class="next" onclick="showCalendar(1)">다음 월</button>
                </div>
                <div id="Calendar_Container"></div>
            </div>
        </div>
    </section>
    <footer id="footer">
        <div class="inner">
            
            
        </div>
        
    </footer>
    <script>
        function generateCalendar(year, month){

            const today = new Date();
            const dayInMonth = new Date(year, month, 0).getDate(); //달의 일수 
            const firstDay = new Date(year, month - 1, 1).getDay(); //달의 첫 요일

            let calendarHTML = '<table>';
            calendarHTML += '<tr><th>일요일</th><th>월요일</th><th>화요일</th><th>수요일</th><th>목요일</th><th>금요일</th><th>토요일</th></tr>'
            let dayCounter = 1;
            let monthCounter = new Date().getMonth();

            for(let i = 0; i < 6; i++) {
                
                calendarHTML += '<tr>';
                
                for(let j = 0; j < 7; j++) {
                    if(i == 0 && j < firstDay){
                        calendarHTML += '<td></td>';
                    }
                    else if(dayCounter > dayInMonth){
                        calendarHTML += '<td></td>';
                    }
                    else {
                        if(dayCounter == today && month == today.getMonth() && year == today.getFullYear()){
                        calendarHTML += `<td id="today">${dayCounter}<div class="plan_div"></div></td>`;
                        }
                        else{
                            calendarHTML += `<td>${dayCounter}<div class="plan_div"></div></td>`;                          
                        }
                        dayCounter++;
                    }
                    
                }

                calendarHTML += '</tr>';
            }

            calendarHTML += '</table>';

            document.getElementById('Calendar_Container').innerHTML = calendarHTML;
            
            if(month == 0){
                document.getElementById('currentYearMonth').innerHTML = `${year - 1}년 ${month + 12}월`;
            }
            else{
                document.getElementById('currentYearMonth').innerHTML = `${year}년 ${month}월`;
            }
            
        }


        const pos = new Date();
        pos.setMonth(pos.getMonth() + 1);

        function showCalendar(change){                 
            if(change == -1){
                prevCalendar(change);
            }
            else{
                nextCalendar(change);
            }
        }

        function prevCalendar(change){
            pos.setMonth(pos.getMonth() + change);      
            generateCalendar(pos.getFullYear(), pos.getMonth()); 
            pos += -1;

        }

        function nextCalendar(change){
            pos.setMonth(pos.getMonth() + change);                  
            generateCalendar(pos.getFullYear(), pos.getMonth());                      
            pos += 1;
        }

        generateCalendar(pos.getFullYear(), pos.getMonth());
    </script>
</body>
</html>